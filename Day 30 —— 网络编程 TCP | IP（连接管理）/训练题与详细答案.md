本节目标：  
**把 TCP 连接管理问题，训练成“面试时的第一反应答案”。**

---

## 题 1：一句话说明三次握手的目的

### 答案

> 确认双方的收发能力，并防止历史连接请求干扰当前连接。

---

## 题 2：为什么 TCP 挥手需要四次？

### 答案

* TCP 是全双工
* 发送和接收方向需要分别关闭
* 被动关闭方可能还有数据未发送完

---

## 题 3：TIME_WAIT 出现在哪一方？

### 答案

* 出现在 **主动关闭连接的一方**
* 客户端更常见

---

## 题 4：TIME_WAIT 的两个核心作用是什么？

### 答案

1. 防止旧连接的数据包影响新连接
2. 确保对方能收到最后一个 ACK

---

## 题 5：CLOSE_WAIT 是否正常？

### 答案

* ❌ 不正常
* 表示应用层未正确关闭 socket
* 本质是代码 Bug

---

## 题 6：线上大量 CLOSE_WAIT，你如何定位？

### 答案

1. netstat 确认状态
2. lsof 找到未关闭 fd
3. 排查：
   * 异常分支
   * early return
   * 连接池逻辑

---

## 题 7：TIME_WAIT 多一定要优化吗？

### 答案

* 不一定
* 它是协议设计
* 应优先通过：
  * 长连接
  * 连接复用
  来减少

---

## 题 8：一句话区分 TIME_WAIT 和 CLOSE_WAIT

### 标准回答

> TIME_WAIT 是协议层的善后机制，  
> CLOSE_WAIT 是应用层没有善后。
